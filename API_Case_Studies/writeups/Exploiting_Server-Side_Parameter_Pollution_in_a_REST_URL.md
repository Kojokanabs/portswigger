Exploiting Server-Side Parameter Pollution in a REST URL

# Description
The application constructs internal REST API paths using unsafely concatenated user input. By injecting path separators and special URL characters into a request parameter, an attacker can manipulate the server-side request structure, access unintended API routes, and extract sensitive data 

# Testing Context
* Platform: PortSwigger Web Security Academy
* Scenario: Server-side parameter pollution via REST URL path manipulation
* Target: /forgot-password endpoint and internal REST API
* Attacker goal: Extract password reset token for a privileged user

# Exploitation Steps
1 Trigger a password reset request and intercept the POST /forgot-password request
2 Modify the username parameter with encoded URL control characters (#, ?) to observe route-level errors
3 Confirm that user input is being injected into the server-side URL path based on truncation behavior
4 Use path traversal sequences (../) to escape the intended API route
5 Enumerate API definition files by injecting common filenames into the path
6 Extract an internal API endpoint structure that includes both username and field path parameters.
7 Inject a crafted path segment to introduce a controlled field parameter
8 Identify valid field values accepted by the internal API.
9 Switch API versions to access functionality not intended for the exposed application flow
10 Retrieve a password reset token for a privileged user
11 Complete the password reset and gain administrative access

# Security Impact
* Exposure of password reset tokens
* Full account takeover of privileged users
* Compromise of administrative functionality

# Root Cause
* User-controlled input is concatenated directly into internal REST API paths without normalization or escaping
* The backend fails to enforce strict routing boundaries between exposed and internal APIs
* API versioning and internal endpoints are accessible through user-manipulated paths.

# Why Automated Tools Often Miss This
* The vulnerability relies on path construction logic, not malformed input
* Detection requires iterative reasoning about URL parsing behavior and routing
* Automated scanners rarely combine path traversal, API discovery, and business logic abuse in a single attack chain.
* Exploitation depends on interpreting nuanced server error messages

# Secure-by-Design-Mitigation
* Never construct internal URLs using unsanitized user input
* Enforce strict routing and API boundary validation
* Separate public and internal APIs at the infrastructure level

# OWASP Mapping
* OWASP Top 10: A01 – Broken Access Control
* OWASP API Top 10: API8 – Security Misconfiguration
