Exploiting a Mass Assignment Vulnerability

# Description
The application accepts client‑supplied JSON objects and automatically binds them to backend data models without enforcing a strict allowlist. This enables attackers to inject additional parameters that were never intended to be user‑controlled, leading to unauthorized modification of sensitive application state

# Testing Context
* Platform: PortSwigger Web Security Academy
* Scenario: Mass assignment via API request body manipulation
* Target: /api/checkout endpoint

# Exploitation Steps
1 Authenticate as a normal user and attempt to place an order that exceeds available credit
2 Intercept the GET /api/checkout and POST /api/checkout requests using Burp Proxy.
3 Compare both requests and observe that the GET response exposes a chosen_discount object not included in the POST request.
4 Send the POST /api/checkout request to Repeater and inject the missing chosen_discount parameter into the JSON body
5 Modify the injected parameter to confirm it is processed by the backend.
6 Increase the chosen_discount.percentage value to an excessive amount.
7 Submit the modified request and observe that the order completes despite insufficient credit

# Security Impact
* Unauthorized price or discount manipulation
* Financial loss and abuse of promotional logic
* Compromise of transactional integrity

# Root Cause 
* The backend automatically maps client‑supplied JSON fields to internal objects without validating which fields are user‑modifiable.
* Sensitive business logic parameters are not protected by server‑side allowlists
* The API implicitly trusts that clients will only submit fields used by the front‑end

# Why Automated Tools Often Miss This
* The vulnerability relies on structural manipulation of JSON rather than malformed input
* Automated scanners rarely diff GET and POST response structures to identify hidden parameters
* Exploitation requires business logic understanding, not payload fuzzing
* The API behaves as designed from a schema perspective, making it difficult to flag generically

# Secure‑by‑Design-Mitigation
* Enforce strict allowlists for client‑assignable fields
* Separate internal pricing logic from client‑supplied data
* Validate business‑critical values independently of client input

# OWASP Mapping
* OWASP Top 10: A01 – Broken Access Control
* OWASP API Top 10: API6 – Mass Assignment

