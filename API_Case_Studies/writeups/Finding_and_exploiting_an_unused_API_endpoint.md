Finding and exploiting an unused API endpoint

# Description
The application exposes an API endpoint that supports additional HTTP methods beyond those used by the front-end. Although the UI only performs read operations, the backend API allows state‑changing requests that are insufficiently protected. An attacker can discover and exploit this unused API functionality to manipulate sensitive application data.

# Testing Context
* PLatform: PortSigger Web Security Academy
* Scenario: Discovering and abusing unused API functionality 
* Target: /api/products/{id}/price endpoint
* Authenticated user context

# Exploitation Steps
1 Intercept a product price API request (e.g. GET /api/products/3/price) using Burp Proxy.
2 Send the request to Repeater and change the HTTP method to OPTIONS to enumerate allowed methods.
3 Observe that the endpoint supports additional methods such as PATCH.
4 Attempt a PATCH request while unauthenticated and receive an authorization error.
5 Authenticate as a normal user and resend the PATCH request.
6 Adjust the request to match backend expectations:
  * Set Content-Type: application/json
  * Provide a JSON body with a price parameter.
7 Modify the price value (e.g. { "price": 0 }) and send the request.
8 Reload the product page and confirm that the price has been updated
9 Purchase the product at the manipulated price to complete the attack

# Security Impact 
* Unauthorized modification of business-critical data
* Financial loss through price manipulation
* Breakdown of trust in transactional integrity

# Root Cause
* The backend API exposes state-changing methods that are not required by the application's intended functionality
* Authorization checks are incomplete or inconsistent, allowing low‑privileged users to perform sensitive operations.
* API design assumes that unsupported functionality is unreachable simply because the UI does not expose it

# Why Automated Tools Often Miss This
* The vulnerability depends on method discovery (OPTIONS) rather than malformed input
* Automated scanners rarely test alternative HTTP methods on otherwise benign endpoints
* Exploitation requires authenticated context and an understanding of business intent, not just technical flaws
* The behavior appears legitimate at the HTTP level and does not trigger typical injection signatures

# Secure‑by‑Design-Mitigation
* Explicitly restrict allowed HTTP methods per endpoint
* Enforce strict, role‑based authorization for all state‑changing operations
* Remove unused or legacy API functionality from production

# OWASP Mapping 
* OWASP Top 10:A01 – Broken Access Control
* OWASP API Top 10: API5 – Broken Function Level Authorization


