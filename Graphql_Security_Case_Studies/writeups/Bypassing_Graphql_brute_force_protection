Bypassing_Graphql_brute_force_protection

# Description
THe GraghQL API implements rate-limiting controls on authentication requests to prevent brute-force attacks.
However, the protection is enforced per HTTP request rather than per GraphQLA operation. 
By abusing GraphQL aliases, attackers can perform multiple login attemps within a single request, effectively bypassing brute-force protections.

# Testing Context:
* Platform: PortSwigger Web Security Academy
* Scenario: Bypassing GraphQL brute force protections

# Exploitation Steps(Python-based approach)
1. Intercept a GraphQL login request using burp Suite.
2. Identify the authentication mutation used for login.
3. Generate multiple aliased login mutations, each containing different credentials.
4. Combine aliased mutations into a single GraphQL reqiest(using python script)
5. Send the request to the GraphQL endpoint
6. Observe the response to identify a successful authentication attempt 

# Security Impact
* Bypass of authentication rate-limiting controls
* Enables large-scale brute-force attacks
* Increased risk of account takeover 
* Compromises the effectiveness of authentication security controls

# Root Cause Analysis 
* Rate limiting is applied at HTTP request level instead of the GraphQL resolver level
* Authentication logic does not account fpr GraphQL features such as aliases.
* Security controls are designed with REST assumptions and reused for GraphQL APIs without proper threat modeling.

# Why Automated Tools Often Miss This
* The vulnerability is logic based rather than injection-based
* Requires crafting aliased GraphQL mutations to trigger
* Automated scanners typically treat a GraphQL request as a single authentication attempt.
 
# Secure-by-Design Mitigations
* Apply rate limiting per resolver or per authentication attempt mutation.
* Restrict or disable GraphQL aliases on sensitive mutations such as login
* Implement account-based lockout and behavioral anomaly detection
* Design authentication controls with GraphQL-specific threat models

# OWASP Mapping
* OWASP API Top 10:API2 - Broken Authentication
* OWASP Top 10:AO7 - Identification and Authntication Failures 
