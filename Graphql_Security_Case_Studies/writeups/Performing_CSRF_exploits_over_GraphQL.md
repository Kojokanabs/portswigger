# Description
This Lab desmostrates a CSRF vulnerability in GraphQL API that accepts application/x-www-form-urlencoded requests, making it susceptible to cross-site request forgery.

# Lab Setup
* GraphQL endpoint support form-encoded request
* User authenticated via 
* Exploit server available

# Exploitation Steps
1. Logged in using the provideded credentials(wiener:peter)
2. Identified a GraphQL mutation that updates the user email
3. Confirmed the endpoint acceped x-www-urlencoded content type(Just change the method twice)
4. Crafted a malicious HTML form that:
*  Authomatically submit a POST request
*  Execute a GraphQL mutation to change the victim's email
5. Upload the HTML file to the exploit server
6. Deliver the exploit to the victim 

# Result
* Victim's email address was changed without consent
* CSRF attack executed successfully 

# Weakness
* No CSRF protection on GraphQL endpoint
* Acceptance of form-encoded requests
* Reliance on cookies for authentication

# Mitigation
* Enforce CSRF tokens
* Reject non-JSON GraphQL requests
* Use SamSite cookies
* Validate request origin
