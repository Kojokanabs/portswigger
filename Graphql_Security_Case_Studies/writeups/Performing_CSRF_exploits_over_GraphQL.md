Performing CSRF Exploit over GraphQL

# Description
The GraphQL API accepts application/x-www-form-urlencoded requests and relies on cookie-based authentication.
Because no CSRF protections are enforced, an attacker can craft a malicious cross-site request that triggers authenticated GraphQL mutations on behalf of a victim, resulting in unauthorized state-changing actions.

# Testing Context
* Platform: PortSwigger Web Security Academy
* Senarios: Performing CSRF exploit over GraphQL 

# Exploitation Steps
1. Log in using the provideded credentials(wiener:peter)
2. Identify a GraphQL mutation that updates the authenticated user's email address.
3. Confirmed that the GraphQL endpoint accepts application/x-www-urlencoded request by modifying the request method and content type content type
4. Crafted a malicious HTML form that:
      Authomatically submit a POST request
      Execute a GraphQL mutation to change the victim's email
5. Host the maalicious HTML on the exploit server
6. Deliver the exploit link to the victim server 

# Security Impact
* Unauthorized state-changing actions performed on behalf of authenticated users
* Account data maipulated without user consent
* Enable account takeover or persistent via email modification
* Breaks trust boundaries between the browser, user and API

# Root Cause Analysis
* The GraphQL endpoint does not implement CSRF protections
* THe API accepts non-JSON request formats suitable for cross-origin form submission
* Authentication relies solely on cookies without additional request validation
* GraphQL security assumptions do not account for browser-based attack vectors

# Why Automated Tools Often Miss This
* THe vulnerability depends on browser behavior, not malformed input
* Automated scanners rarely test GraphQL endpoints with form-endcoded payloads
* CSRF issues requires contextual understanding of authenticated and request format
* THe attack requires a cross-origin delivery mechanism rather than direct API interaction.

# Secure-by-Design Mitigations
* Enforce CSRF tokens on all state-changing GraphQL mutations
* Reject non-JSON (application/json) requests for GraphQL endpoints
* Use SamSite=Strict cookies where applicable
* Validate request origin and Content-Type headers
* Treat GraphQL endpoints as browser-exposed APIs during threat modeling

# OWASP Mapping
* OWASP Top 10:A01 - Broken Access Control
* OWASP Top 10:A05 - Security Misconfiguration
